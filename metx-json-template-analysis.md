# MetX JSON Template Analysis

## Overview
Analysis of MetX JSON structure to identify static prefix/suffix for simple dashboard with one tab and one map.

## JSON Structure Breakdown

### **STATIC PREFIX** (Everything before dynamic content)

```json
{
  "id": {{DASHBOARD_ID}},
  "title": "{{DASHBOARD_TITLE}}",
  "tab_active": {{TAB_ID}},
  "use_global_datetime": false,
  "global_datetime": {
    "is_relative": true,
    "is_series": false,
    "is_auto_time_refresh_on": false,
    "abs_start": "{{DATETIME_START}}",
    "abs_end": "{{DATETIME_END}}",
    "rel_rounding_on": true,
    "rel_position": "now_with_15min_precision",
    "rel_rounding_direction": "backward",
    "rel_shift_on": true,
    "rel_start": "PT-15M",
    "rel_end": "P1D",
    "temporal_resolution": "PT3H",
    "fps": 10,
    "id": {{GLOBAL_DT_ID}},
    "id_profile": {{PROFILE_ID}},
    "time_created": "{{TIMESTAMP}}",
    "time_updated": "{{TIMESTAMP}}"
  },
  "id_account": {{ACCOUNT_ID}},
  "time_created": "{{TIMESTAMP}}",
  "time_updated": "{{TIMESTAMP}}",
  "tabs": [
    {
      "id": {{TAB_ID}},
      "id_profile": {{PROFILE_ID}},
      "time_created": "{{TIMESTAMP}}",
      "time_updated": "{{TIMESTAMP}}",
      "title": "{{TAB_TITLE}}",
      "order": 1,
      "is_favorite": false,
      "datetime": {
        "is_relative": true,
        "is_series": false,
        "is_auto_time_refresh_on": false,
        "abs_start": "{{DATETIME_START}}",
        "abs_end": "{{DATETIME_END}}",
        "rel_rounding_on": true,
        "rel_position": "now_with_15min_precision",
        "rel_rounding_direction": "backward",
        "rel_shift_on": true,
        "rel_start": "PT-15M",
        "rel_end": "P1D",
        "temporal_resolution": "PT3H",
        "fps": 10,
        "id": {{TAB_ID}},
        "id_profile": {{PROFILE_ID}},
        "time_created": "{{TIMESTAMP}}",
        "time_updated": "{{TIMESTAMP}}"
      },
      "layouts": [
        {
          "gridCellLayout": {
            "gridColumnStart": 1,
            "gridColumnEnd": 97,
            "gridRowStart": 1,
            "gridRowEnd": 97
          },
          "id": {{LAYOUT_ID}},
          "id_tab": {{TAB_ID}},
          "type": "Map",
          "id_tool": {{MAP_ID}}
        }
      ],
      "viewports": [
        {
          "kind": "ViewportFull",
```

### **DYNAMIC CONTENT** (Generated by LLM)
```json
          "center_lng": {{LONGITUDE}},
          "center_lat": {{LATITUDE}},
          "zoom": {{ZOOM_LEVEL}},
          "southWest_lng": {{SW_LONGITUDE}},
          "southWest_lat": {{SW_LATITUDE}},
          "northEast_lng": {{NE_LONGITUDE}},
          "northEast_lat": {{NE_LATITUDE}},
```

### **CONTINUE STATIC**
```json
          "id": {{VIEWPORT_ID}},
          "id_profile": {{PROFILE_ID}},
          "lastUpdatedBy": {{MAP_ID}}
        }
      ],
      "country_plots": [],
      "energy_plots": [],
      "maps": [
        {
          "gridCellLayout": {
            "gridColumnStart": 1,
            "gridColumnEnd": 97,
            "gridRowStart": 1,
            "gridRowEnd": 97
          },
          "id": {{MAP_ID}},
          "id_profile": {{PROFILE_ID}},
          "id_tab": {{TAB_ID}},
          "id_viewport": {{VIEWPORT_ID}},
          "time_created": "{{TIMESTAMP}}",
          "time_updated": "{{TIMESTAMP}}",
```

### **DYNAMIC MAP CONTENT** (Main LLM target)
```json
          "title": "{{MAP_TITLE}}",
          "titleStyle": {{TITLE_STYLE_OBJECT_OR_NULL}},
          "time_offset_mins": 0,
          "legend_size": null,
          "map_projection": {{PROJECTION_OBJECT_OR_NULL}},
          "lod_bias": 0,
          "layers": [
            // THIS IS THE MAIN DYNAMIC SECTION - Array of layer objects
            // Background layer (usually first)
            {
              "time_created": "{{TIMESTAMP}}",
              "time_updated": "{{TIMESTAMP}}",
              "id": {{LAYER_ID}},
              "id_profile": {{PROFILE_ID}},
              "id_cartographicmap": {{MAP_ID}},
              "index": 0,
              "opacity": 1,
              "show": true,
              "calibrated": null,
              "vertical_interpolation": null,
              "experimental": false,
              "custom_options": {
                "line_color": null,
                "show_state_border": null,
                "map_label_language": null
              },
              "kind": "BackgroundMapDescription",
              "style": "{{BACKGROUND_STYLE}}"
            },
            // Additional weather layers...
            // Each layer has specific parameters based on kind:
            // - WmsLayerDescription
            // - LightningLayerDescription  
            // - BarbsLayerDescription
            // - SymbolLayerDescription
            // - IsoLinesLayerDescription
            // etc.
          ],
          "drawing": null
        }
      ],
```

### **STATIC SUFFIX**
```json
      "notes": [],
      "plots": [],
      "location_tables": [],
      "tephigrams": [],
      "weather_tables": []
    }
  ]
}
```

## Key Observations

### Static Elements (Prefix/Suffix):
1. **Root structure** - Basic dashboard metadata fields
2. **Global datetime configuration** - Standard time settings
3. **Tab structure** - Layout and viewport container setup
4. **Array containers** - Empty arrays for unused features (plots, notes, etc.)

### Dynamic Elements (LLM Generated):
1. **Dashboard/Tab titles**
2. **Geographic viewport bounds** (center, zoom, bounds)
3. **Map title and styling**
4. **Layer configurations** - The core weather visualization setup
   - Layer types (WMS, Lightning, Barbs, Symbols, etc.)
   - Weather parameters (temperature, wind, precipitation, etc.)
   - Visual styling (colors, opacity, sizes)
   - Data models and units

### ID Management Strategy:
- Use placeholder patterns like `{{DASHBOARD_ID}}`, etc.
- IDs need to be consistent across related objects
- Can use sequential numbering or UUID generation

## Recommended Template Approach

**Prefix:** Everything up to the `"layers": [` in the map object
**Dynamic Content:** The layers array contents  
**Suffix:** Everything after the layers array closes

This allows LLMs to focus on generating just the weather layer configurations while maintaining proper JSON structure. 